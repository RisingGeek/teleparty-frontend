"use strict";exports.id=54,exports.ids=[54],exports.modules={126:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SocketMessageTypes=void 0,function(e){e.CREATE_SESSION="createSession",e.JOIN_SESSION="joinSession",e.SEND_MESSAGE="sendMessage",e.SET_TYPING_PRESENCE="setTypingPresence"}(t.SocketMessageTypes||(t.SocketMessageTypes={}))},2950:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SocketCallbackManager=void 0;class s{constructor(){this._callbackMap=new Map}makeId(){let e="";for(let t=0;t<16;t+=1)e+="0123456789abcdef"[Math.floor(16*Math.random())];return e}executeCallback(e,t){let s=this._callbackMap.get(e);s&&(s(t),this._callbackMap.delete(e))}addCallback(e){let t=this.makeId();for(;this._callbackMap.has(t);)t=this.makeId();return this._callbackMap.set(t,e),t}}t.SocketCallbackManager=s},3272:function(e,t,s){var a=this&&this.__awaiter||function(e,t,s,a){return new(s||(s=Promise))(function(n,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function l(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?n(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(o,l)}c((a=a.apply(e,t||[])).next())})};Object.defineProperty(t,"__esModule",{value:!0}),t.TelepartyClient=void 0;let n=s(2950),r=s(126);class o{constructor(e){this._socketEventHandler=e,this._socket=new WebSocket("wss://uwstest.teleparty.com"),this._callbackManager=new n.SocketCallbackManager,this._handleSocketEvents(),this._reconnectAttempts=0}_handleSocketEvents(){this._socket.onmessage=this._onMessage.bind(this),this._socket.onclose=this._onClose.bind(this),this._socket.onerror=this._onError.bind(this),this._socket.onopen=this._onOpen.bind(this)}_onMessage(e){try{let t=JSON.parse(e.data);t.callbackId?this._callbackManager.executeCallback(t.callbackId,t.data):this._socketEventHandler.onMessage(t)}catch(e){}}_onOpen(){this._socketEventHandler.onConnectionReady()}_onClose(e){this._socketEventHandler.onClose()}_onError(e){this._socket.close()}_formatMessage(e,t,s){return{type:e,data:t,callbackId:s}}joinChatRoom(e,t,s){return a(this,void 0,void 0,function*(){let a={videoId:"0",sessionId:t,videoService:"netflix",permId:"0000000000000000",userSettings:{userIcon:s,userNickname:e}},n=yield new Promise(e=>{this.sendMessage(r.SocketMessageTypes.JOIN_SESSION,a,t=>{e(t)})});if(n.errorMessage)throw Error(n.errorMessage);return{messages:n.messages}})}createChatRoom(e,t){return a(this,void 0,void 0,function*(){let s={controlLock:!1,videoId:"0",videoDuration:0,videoService:"netflix",permId:"0000000000000000",userSettings:{userIcon:t,userNickname:e}},a=yield new Promise(e=>{this.sendMessage(r.SocketMessageTypes.CREATE_SESSION,s,t=>{e(t)})});if(a.errorMessage)throw Error(a.errorMessage);return a.sessionId})}sendMessage(e,t,s){if(1==this._socket.readyState){let a="null";s&&(a=this._callbackManager.addCallback(s));let n=this._formatMessage(e,t,a);this._socket.send(JSON.stringify(n))}else s&&s({errorMessage:"Connection isn't Ready yet."})}teardown(){try{this._socket.close(4500)}catch(e){}this._reconnectTimeOut&&clearTimeout(this._reconnectTimeOut),this._keepAliveInterval&&clearInterval(this._keepAliveInterval)}}t.TelepartyClient=o},7054:(e,t,s)=>{s.r(t),s.d(t,{default:()=>l});var a=s(5512),n=s(9334),r=s(8009),o=s(7895);let l=e=>{let{handleBackClick:t}=e,[s,l]=(0,r.useState)(""),[c,i]=(0,r.useState)(""),[d,u]=(0,r.useState)(!0),h=(0,n.useRouter)(),k=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=new o.Ul({onConnectionReady:()=>{u(!1)},onClose:()=>{console.log("Socket has been closed")},onMessage:e=>{console.log("message",e)}});return k.current=e,()=>{k.current?.teardown()}},[]);let m=async()=>{if(!s.trim()){i("Please enter a nickname");return}sessionStorage.setItem("teleparty-nickname",s);let e=await k.current?.createChatRoom(s,"userIon");h.push(`/room/${e}`),i("")};return d?(0,a.jsx)("div",{className:"flex flex-col justify-center items-center h-96",children:(0,a.jsx)("div",{className:"w-10 h-10 border-4 border-blue-500 border-t-transparent rounded-full animate-spin"})}):(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsx)("h2",{className:"text-lg text-black font-semibold mb-4",children:"Create a New Chat Room"}),c&&(0,a.jsx)("p",{className:"text-red-500 mb-4",children:c}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Your Nickname"}),(0,a.jsx)("input",{type:"text",value:s,onChange:e=>l(e.target.value),className:"w-full p-2 border text-black border-gray-300 rounded",placeholder:"Enter your nickname"})]}),(0,a.jsx)("button",{onClick:m,className:"w-full bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded transition cursor-pointer",children:"Create Room"}),(0,a.jsx)("button",{className:"w-full bg-gray-300 hover:bg-gray-400 text-gray-800 py-2 px-4 rounded transition cursor-pointer",onClick:t,children:"Back"})]})]})}},7895:(e,t,s)=>{t.Ul=t.mw=void 0;let a=s(126);Object.defineProperty(t,"mw",{enumerable:!0,get:function(){return a.SocketMessageTypes}});let n=s(3272);Object.defineProperty(t,"Ul",{enumerable:!0,get:function(){return n.TelepartyClient}})}};